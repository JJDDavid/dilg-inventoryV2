{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DILG Supply Inventory</title>
  <link rel="icon" href="{% static 'img/dilg_logo_tab.png' %}" type="image/png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    :root {
      --red-strong: #c1121f;
      --red-dark: #8f0d18;
      --gold: #f4b400;
      --orange: #f28c28;
      --slate: #0f1115;
      --slate-2: #181b22;
      --text-muted: #c7c7c7;
    }
    body {
      background: #f8f9fb;
      min-height: 100vh;
      color: #0f1115;
    }
    .app-shell {
      min-height: 100vh;
    }
    .sidebar {
      width: 260px;
      flex: 0 0 260px;
      background: linear-gradient(180deg, var(--slate) 0%, var(--slate-2) 100%);
      color: #fff;
      min-height: 100vh;
    }
    .brand-mark {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--red-strong), var(--orange));
      display: grid;
      place-items: center;
      font-weight: 800;
      color: #fff;
      margin-right: 12px;
    }
    .brand-logo {
      width: 48px;
      height: 48px;
      border-radius: 14px;
      background: linear-gradient(135deg, rgba(193, 18, 31, 0.85), rgba(244, 180, 0, 0.85));
      display: grid;
      place-items: center;
      box-shadow: 0 6px 14px rgba(0,0,0,0.25);
      margin-right: 12px;
    }
    .brand-logo img {
      border-radius: 20px;
      width: 40px;
      height: 40px;
      object-fit: contain;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
    }
    .sidebar .nav-link {
      color: #eaeaea;
      border-radius: 10px;
      padding: 10px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
    }
    .sidebar .nav-link:hover {
      background: rgba(244, 180, 0, 0.1);
      color: #fff;
    }
    .sidebar .nav-link.active {
      background: linear-gradient(90deg, var(--red-strong), var(--orange));
      color: #fff;
      box-shadow: 0 6px 14px rgba(0,0,0,0.25);
    }
    .sidebar hr {
      border-color: rgba(255,255,255,0.12);
    }
    .main-panel {
      background: #f8f9fb;
      flex: 1 1 auto;
      min-width: 0;
    }
    .top-bar {
      background: #fff;
      border-bottom: 1px solid #e8e8ef;
      position: sticky;
      top: 0;
      z-index: 900;
      min-height: 56px;
    }
    .badge-soft {
      background: rgba(241, 18, 31, 0.12);
      color: var(--red-strong);
      font-weight: 600;
    }
    .btn-primary {
      background: linear-gradient(90deg, var(--red-strong), var(--orange));
      border: none;
    }
    .btn-primary:hover {
      background: linear-gradient(90deg, var(--red-dark), var(--orange));
    }
    .btn-outline-primary {
      color: var(--red-strong);
      border-color: var(--red-strong);
    }
    .btn-outline-primary:hover {
      background: var(--red-strong);
      color: #fff;
    }
    .card-header {
      background: #fff;
      font-weight: 700;
    }
    @media (max-width: 991.98px) {
      .sidebar {
        width: 100%;
        position: sticky;
        top: 0;
        z-index: 1000;
      }
    }
      .content-shell {
        padding: 24px;
        width: 100%;
      }
      h1, h2, h3, h4 {
        font-weight: 800;
        color: #0f1115;
        letter-spacing: -0.5px;
      }
      .card {
        border: none;
        box-shadow: 0 10px 30px rgba(0,0,0,0.06);
        border-radius: 16px;
      }
      .card + .card {
        margin-top: 18px;
      }
      .card-header {
        background: linear-gradient(90deg, rgba(241, 18, 31, 0.07), rgba(244, 180, 0, 0.07));
        font-weight: 700;
        border-bottom: 1px solid #f0f0f5;
      }
      .table thead th {
        background: linear-gradient(90deg, rgba(244, 180, 0, 0.15), rgba(242, 140, 40, 0.15));
        color: #0f1115;
        border-bottom: 0;
      }
      .table-hover tbody tr:hover {
        background: rgba(244, 180, 0, 0.08);
      }
      .alert {
        border: none;
        border-left: 4px solid var(--orange);
        box-shadow: 0 6px 16px rgba(0,0,0,0.05);
      }
      .form-control:focus, .form-select:focus {
        border-color: var(--orange);
        box-shadow: 0 0 0 0.2rem rgba(242, 140, 40, 0.25);
      }
      .badge-soft {
        background: rgba(241, 18, 31, 0.12);
        color: var(--red-strong);
        font-weight: 600;
      }
      .card-header-strong {
        background: linear-gradient(90deg, rgba(193, 18, 31, 0.16), rgba(242, 140, 40, 0.18));
        color: #0f1115;
      }
      .card-status-pending .card-header {
        background: linear-gradient(90deg, rgba(244, 180, 0, 0.28), rgba(242, 140, 40, 0.18));
        color: #0f1115;
      }
      .card-status-approved .card-header {
        background: linear-gradient(90deg, #0b8f2f, #16c172);
        color: #fff;
      }
      .card-status-rejected .card-header {
        background: linear-gradient(90deg, #b11226, #8f0d18);
        color: #fff;
      }
      .badge-status {
        border-radius: 999px;
        font-weight: 700;
        padding: 6px 10px;
        letter-spacing: 0.2px;
      }
      .badge-status-pending { background: rgba(244, 180, 0, 0.22); color: #8a5a00; }
      .badge-status-approved { background: rgba(0, 153, 74, 0.16); color: #0f7a3c; }
      .badge-status-rejected { background: rgba(193, 18, 31, 0.18); color: #8f0d18; }
  </style>
</head>
<body>
  <div class="d-flex app-shell">
    <nav class="sidebar d-flex flex-column p-3">
      <div class="d-flex align-items-center mb-4">
        <div class="brand-logo">
          <img src="{% static 'img/dilg_logo.png' %}" alt="DILG Logo">
        </div>
        <div>
          <div class="fw-bold">DILG Inventory</div>
          <div class="text-muted small" style="color: var(--text-muted) !important;">Supply Tracker</div>
        </div>
        <button class="btn btn-sm btn-outline-light ms-auto d-lg-none" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu" aria-controls="navMenu" aria-expanded="false" aria-label="Toggle navigation">Menu</button>
      </div>

      {% if user.is_authenticated %}
      <div class="text-muted small mb-3" style="color: var(--text-muted) !important;">Signed in as {% if user.is_staff %}Admin {% endif %}{{ user.username }}</div>
      {% endif %}

      <div class="collapse d-lg-block" id="navMenu">
        <ul class="nav flex-column gap-1 mb-4">
          {% if user.is_authenticated and user.is_staff %}
          <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" href="{% url 'dashboard' %}">Dashboard</a></li>
          <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'supply_list' %}active{% endif %}" href="{% url 'supply_list' %}">Supplies</a></li>
          <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'record_incoming' %}active{% endif %}" href="{% url 'record_incoming' %}">Incoming</a></li>
          <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'request_list' %}active{% endif %}" href="{% url 'request_list' %}">Supply Request Management</a></li>
          <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'request_history' %}active{% endif %}" href="{% url 'request_history' %}">Request History</a></li>
          <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'profile_settings' %}active{% endif %}" href="{% url 'profile_settings' %}">Profile Settings</a></li>
          {% endif %}
          {% if user.is_authenticated and not user.is_staff %}
          <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'request_select_supplies' %}active{% endif %}" href="{% url 'request_select_supplies' %}">Select Supplies</a></li>
          <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'request_create' %}active{% endif %}" href="{% url 'request_create' %}">Request Form</a></li>
          <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'request_list' %}active{% endif %}" href="{% url 'request_list' %}">My Requests</a></li>
          <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'request_history_user' %}active{% endif %}" href="{% url 'request_history_user' %}">Request History</a></li>
          <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'profile_settings' %}active{% endif %}" href="{% url 'profile_settings' %}">Profile Settings</a></li>
          {% endif %}
        </ul>
        <div class="mt-auto">
          {% if user.is_authenticated %}
          <form method="post" action="{% url 'logout' %}">
            {% csrf_token %}
            <button class="btn btn-outline-light w-100" type="submit">Logout</button>
          </form>
          {% else %}
          <a class="btn btn-outline-light w-100" href="{% url 'login' %}">Login</a>
          {% endif %}
        </div>
      </div>
    </nav>

    <div class="flex-grow-1 main-panel">
      <div class="top-bar px-3 py-2 d-flex align-items-center justify-content-between">
        <div class="fw-bold">Supply Operations</div>
        {% if messages %}
        <span class="badge badge-soft">{{ messages|length }} notice{{ messages|length|pluralize }}</span>
        {% endif %}
      </div>
      <main class="container-fluid py-3 content-shell">
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }} shadow-sm">{{ message }}</div>
        {% endfor %}
        {% block content %}{% endblock %}
      </main>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  {% block extra_js %}{% endblock %}
</body>
</html>
