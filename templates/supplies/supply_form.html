{% extends 'base.html' %}
{% block content %}
<style>
  .supply-hero {
    background: linear-gradient(120deg, rgba(193, 18, 31, 0.08), rgba(244, 180, 0, 0.14));
    border: 1px solid rgba(0,0,0,0.03);
    border-radius: 16px;
    padding: 16px 18px;
    margin-bottom: 18px;
  }
  .supply-hero h2 { margin: 0 0 6px 0; }
  .supply-hero p { margin: 0; color: #6c757d; }
  .field-label { font-weight: 700; color: #0f1115; }
</style>

<div class="supply-hero">
  <h2 class="mb-1">{{ title }}</h2>
  <p>Define the supply details. Units help track stock accurately (e.g., box, pc, pack).</p>
</div>

<form method="post" class="card card-body shadow-sm">
  {% csrf_token %}
  <div class="row g-3">
    <div class="col-lg-6">
      <label class="form-label field-label">{{ form.name.label }}</label>
      {{ form.name }}
      {% for error in form.name.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
    </div>
    <div class="col-lg-6">
      <label class="form-label field-label">{{ form.size_spec.label }}</label>
      {{ form.size_spec }}
      {% for error in form.size_spec.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
    </div>
    <div class="col-lg-6">
      <label class="form-label field-label">{{ form.category.label }}</label>
      {{ form.category }}
      {% for error in form.category.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
    </div>
    <div class="col-lg-6">
      <label class="form-label field-label">{{ form.description.label }}</label>
      {{ form.description }}
      {% for error in form.description.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
    </div>
    <div class="col-lg-4">
      <label class="form-label field-label">{{ form.boxes_count.label }}</label>
      {{ form.boxes_count }}
      {% for error in form.boxes_count.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
    </div>
    <div class="col-lg-4">
      <label class="form-label field-label">{{ form.items_per_box.label }}</label>
      {{ form.items_per_box }}
      {% for error in form.items_per_box.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
    </div>
    <div class="col-lg-4">
      <label class="form-label field-label">{{ form.quantity.label }}</label>
      {{ form.quantity }}
      {% for error in form.quantity.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
    </div>
    <div class="col-lg-4">
      <label class="form-label field-label">{{ form.unit.label }}</label>
      {{ form.unit }}
      {% for error in form.unit.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
    </div>
  </div>
  <div class="d-flex gap-2 mt-3">
    <button class="btn btn-primary" type="submit">Save</button>
    <a class="btn btn-secondary" href="{% url 'supply_list' %}">Cancel</a>
  </div>
</form>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const boxesInput = document.getElementById('id_boxes_count');
    const itemsInput = document.getElementById('id_items_per_box');
    const unitSelect = document.getElementById('id_unit');
    const quantityInput = document.getElementById('id_quantity');

    if (!boxesInput || !itemsInput || !unitSelect || !quantityInput) return;

    quantityInput.readOnly = true; // keep quantity in sync with boxes/items

    const updateQuantity = () => {
      const boxes = parseInt(boxesInput.value, 10) || 0;
      const perBox = parseInt(itemsInput.value, 10) || 0;
      const unit = unitSelect.value;
      quantityInput.value = (unit === 'pack' || unit === 'ream') ? boxes : boxes * perBox;
    };

    boxesInput.addEventListener('input', updateQuantity);
    itemsInput.addEventListener('input', updateQuantity);
    unitSelect.addEventListener('change', updateQuantity);
    updateQuantity();
  });
</script>
{% endblock %}
